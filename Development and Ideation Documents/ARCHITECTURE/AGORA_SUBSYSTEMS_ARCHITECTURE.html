<!DOCTYPE html>
<html>
<head>
<title>AGORA_SUBSYSTEMS_ARCHITECTURE.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<link rel="stylesheet" href="print-styles.css" media="print">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="agora-subsystems-architecture-guide">Agora Subsystems Architecture Guide</h1>
<h2 id="extended-reference-for-specialized-subsystems">Extended Reference for Specialized Subsystems</h2>
<p>This companion document provides detailed architecture diagrams and explanations for specialized Agora subsystems including Debate Sheets, Plexus, Discussions, Schemes, Thesis, KB Wikis, Discourse Dashboard, and the Evidence/Sources system.</p>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#1-agora--debate-sheets">Agora / Debate Sheets</a></li>
<li><a href="#2-plexus-network-system">Plexus Network System</a></li>
<li><a href="#3-discussions-system">Discussions System</a></li>
<li><a href="#4-argument-schemes-system">Argument Schemes System</a></li>
<li><a href="#5-thesis-system">Thesis System</a></li>
<li><a href="#6-kb-wikis-system">KB Wikis System</a></li>
<li><a href="#7-discourse-dashboard">Discourse Dashboard</a></li>
<li><a href="#8-evidence--sources--citations">Evidence / Sources / Citations</a></li>
<li><a href="#9-stacks--libraries">Stacks &amp; Libraries</a></li>
<li><a href="#10-deliberate-button-flow">Deliberate Button Flow</a></li>
</ol>
<hr>
<h1 id="1-agora--debate-sheets">1. Agora / Debate Sheets</h1>
<h2 id="overview">Overview</h2>
<p>Debate Sheets provide a <strong>spreadsheet-like view</strong> of arguments in a deliberation, showing confidence scores, support values, and argument networks in a scannable format.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph DebateSheet["Debate Sheet System"]
        DSR[DebateSheetReader]
        DSH[DebateSheetHeader]
        DSF[DebateSheetFilters]
        ANC[ArgumentNetworkCard]
    end
    
    subgraph DataSources["Data Sources"]
        EV["/api/deliberations/:id/evidential"]
        CL["/api/claims"]
        AR["/api/arguments"]
    end
    
    subgraph Confidence["Confidence System"]
        UC[useConfidence Hook]
        CM["Confidence Modes:<br/>â€¢ product<br/>â€¢ min<br/>â€¢ ds (Dempster-Shafer)"]
        TAU["Threshold (Ï„)"]
    end
    
    subgraph Display["Display Components"]
        SB[SupportBar]
        CC[ClaimConfidence]
        EMT[EvalModeToggle]
    end
    
    DSR --> DSH & DSF
    DSR --> ANC
    DSR --> UC
    UC --> CM & TAU
    DSR --> EV
    EV --> CL & AR
    DSR --> Display
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEBATE SHEETS                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Spreadsheet view of argument confidence &amp; support     â”‚
â”‚                                                                 â”‚
â”‚  KEY COMPONENTS:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ DebateSheetReader    â”‚ Main container                     â”‚ â”‚
â”‚  â”‚ DebateSheetHeader    â”‚ Title, controls, mode toggle       â”‚ â”‚
â”‚  â”‚ DebateSheetFilters   â”‚ Search, sort, filter options       â”‚ â”‚
â”‚  â”‚ ArgumentNetworkCard  â”‚ Individual argument display        â”‚ â”‚
â”‚  â”‚ SupportBar           â”‚ Visual confidence indicator        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  CONFIDENCE MODES:                                              â”‚
â”‚  â€¢ product: Multiply path probabilities                        â”‚
â”‚  â€¢ min: Take minimum confidence                                â”‚
â”‚  â€¢ ds: Dempster-Shafer intervals [bel, pl]                     â”‚
â”‚                                                                 â”‚
â”‚  FILE LOCATIONS:                                                â”‚
â”‚  â€¢ components/agora/DebateSheetReader.tsx                      â”‚
â”‚  â€¢ components/deepdive/v3/debate-sheet/*                       â”‚
â”‚  â€¢ components/evidence/SupportBar.tsx                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="component-breakdown">Component Breakdown</h2>
<pre class="hljs"><code><div>agora/
â”œâ”€â”€ DebateSheetReader.tsx      # Main debate sheet container (533 lines)
â”‚   â”œâ”€â”€ ClaimsPane             # List of claims with scores
â”‚   â””â”€â”€ ArgumentNetworkCard    # Argument display with network preview
â”‚
â”œâ”€â”€ useConfidence.tsx          # Context provider for confidence settings
â”‚   â”œâ”€â”€ mode: 'product'|'min'|'ds'
â”‚   â””â”€â”€ tau: number (threshold)
â”‚
deepdive/v3/debate-sheet/
â”œâ”€â”€ DebateSheetHeader.tsx      # Header with title and controls
â”œâ”€â”€ DebateSheetFilters.tsx     # Filtering and sorting UI
â””â”€â”€ ArgumentNetworkCard.tsx    # Individual argument card
</div></code></pre>
<hr>
<h1 id="2-plexus-network-system">2. Plexus Network System</h1>
<h2 id="overview">Overview</h2>
<p>Plexus is a <strong>meta-level network visualization</strong> showing connections between different deliberation rooms/debates. It visualizes cross-references, shared arguments, and argument transport between deliberations.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph PlexusSystem["Plexus Network System"]
        PX[Plexus.tsx<br/>Main Component]
        PB[PlexusBoard.tsx<br/>Grid View]
        PM[PlexusMatrix.tsx<br/>Matrix View]
        PRM[PlexusRoomMetrics.tsx<br/>Room Stats]
    end
    
    subgraph NetworkData["Network Data Model"]
        RN["RoomNode:<br/>â€¢ id, title<br/>â€¢ nArgs, nEdges<br/>â€¢ accepted/rejected/undecided<br/>â€¢ tags, debateSheetId"]
        ME["MetaEdge:<br/>â€¢ from, to<br/>â€¢ kind, weight"]
    end
    
    subgraph EdgeTypes["Edge Types (MetaEdge.kind)"]
        XR["xref: Cross-reference<br/>(indigo)"]
        OV["overlap: Shared claims<br/>(red)"]
        SR["stack_ref: Stack reference<br/>(amber)"]
        IM["imports: Imported args<br/>(teal)"]
        SA["shared_author: Same user<br/>(slate)"]
    end
    
    subgraph Actions["Link Actions"]
        TR["Transport:<br/>Copy arguments between rooms"]
        LK["Link:<br/>Create cross-references"]
    end
    
    PX --> PB & PM & PRM
    PX --> |fetches| API["/api/agora/network"]
    API --> RN & ME
    ME --> EdgeTypes
    PX --> Actions
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PLEXUS NETWORK                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Meta-network of deliberation rooms &amp; their links      â”‚
â”‚                                                                 â”‚
â”‚  EDGE TYPES (color-coded):                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸŸ£ xref         â”‚ Cross-reference between rooms           â”‚ â”‚
â”‚  â”‚ ğŸ”´ overlap      â”‚ Shared claims/arguments                 â”‚ â”‚
â”‚  â”‚ ğŸŸ  stack_ref    â”‚ Referenced in same stack               â”‚ â”‚
â”‚  â”‚ ğŸŸ¢ imports      â”‚ Arguments imported from another room   â”‚ â”‚
â”‚  â”‚ âš« shared_authorâ”‚ Same author participates               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  VIEW MODES:                                                    â”‚
â”‚  â€¢ Plexus.tsx: Interactive graph with nodes &amp; edges            â”‚
â”‚  â€¢ PlexusBoard.tsx: Grid/card layout                           â”‚
â”‚  â€¢ PlexusMatrix.tsx: Adjacency matrix view                     â”‚
â”‚                                                                 â”‚
â”‚  ACTIONS:                                                       â”‚
â”‚  â€¢ Transport: Copy arguments to another room                   â”‚
â”‚  â€¢ Link: Create explicit cross-reference                       â”‚
â”‚  â€¢ Select: Open room in DeepDivePanel                          â”‚
â”‚                                                                 â”‚
â”‚  FILE LOCATIONS:                                                â”‚
â”‚  â€¢ components/agora/Plexus.tsx (~1010 lines)                   â”‚
â”‚  â€¢ components/agora/PlexusBoard.tsx                            â”‚
â”‚  â€¢ components/agora/PlexusMatrix.tsx                           â”‚
â”‚  â€¢ components/agora/PlexusRoomMetrics.tsx                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="data-model">Data Model</h2>
<pre class="hljs"><code><div><span class="hljs-comment">// Room/Deliberation Node</span>
<span class="hljs-keyword">type</span> RoomNode = {
  id: <span class="hljs-built_in">string</span>;
  title?: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  nArgs: <span class="hljs-built_in">number</span>;        <span class="hljs-comment">// Total arguments</span>
  nEdges: <span class="hljs-built_in">number</span>;       <span class="hljs-comment">// Total edges</span>
  accepted: <span class="hljs-built_in">number</span>;     <span class="hljs-comment">// IN claims count</span>
  rejected: <span class="hljs-built_in">number</span>;     <span class="hljs-comment">// OUT claims count</span>
  undecided: <span class="hljs-built_in">number</span>;    <span class="hljs-comment">// UNDEC claims count</span>
  tags?: <span class="hljs-built_in">string</span>[];
  updatedAt?: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  debateSheetId?: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
};

<span class="hljs-comment">// Edge between rooms</span>
<span class="hljs-keyword">type</span> MetaEdge = {
  <span class="hljs-keyword">from</span>: <span class="hljs-built_in">string</span>;   <span class="hljs-comment">// Source room ID</span>
  to: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// Target room ID</span>
  kind: EdgeKind; <span class="hljs-comment">// Type of connection</span>
  weight: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// Strength of connection</span>
};

<span class="hljs-keyword">type</span> EdgeKind = <span class="hljs-string">'xref'</span> | <span class="hljs-string">'overlap'</span> | <span class="hljs-string">'stack_ref'</span> | <span class="hljs-string">'imports'</span> | <span class="hljs-string">'shared_author'</span>;
</div></code></pre>
<h2 id="network-visualization">Network Visualization</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                 â”‚
â”‚                      PLEXUS NETWORK VIEW                        â”‚
â”‚                                                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚ Room A  â”‚â”€â”€â”€â”€â”€ xref â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Room C  â”‚               â”‚
â”‚     â”‚ 12 args â”‚                      â”‚ 8 args  â”‚               â”‚
â”‚     â”‚ ğŸŸ¢5 ğŸ”´3 â”‚                      â”‚ ğŸŸ¢6 ğŸ”´1 â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜               â”‚
â”‚          â”‚                                â”‚                     â”‚
â”‚       overlap                          imports                  â”‚
â”‚          â”‚                                â”‚                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”               â”‚
â”‚     â”‚ Room B  â”‚â”€â”€â”€shared_authorâ”€â”€â”€â”€â”€â”‚ Room D  â”‚               â”‚
â”‚     â”‚ 20 args â”‚                      â”‚ 15 args â”‚               â”‚
â”‚     â”‚ ğŸŸ¢10ğŸ”´5 â”‚                      â”‚ ğŸŸ¢8 ğŸ”´4 â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                 â”‚
â”‚  Legend: ğŸŸ¢=IN ğŸ”´=OUT âšª=UNDEC                                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="3-discussions-system">3. Discussions System</h1>
<h2 id="overview">Overview</h2>
<p>The Discussions system provides a <strong>casual forum/chat hybrid</strong> for preliminary conversation before formal deliberation. Discussions can spawn deliberations via the &quot;Deliberate&quot; button.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph DiscussionSystem["Discussion System"]
        DV[DiscussionView.tsx]
        DVG[DiscussionViewGlass.tsx]
        DC[DiscussionCard.tsx]
    end
    
    subgraph Modes["Communication Modes"]
        CM[Chat Mode<br/>Real-time messages]
        FM[Forum Mode<br/>Threaded comments]
    end
    
    subgraph Components["Sub-Components"]
        FP[ForumPane / ForumPaneGlass]
        CR[ChatRoom]
        MP[MessageComposer]
        TLS[ThreadListSidebar]
        FRC[ForumRulesCard]
    end
    
    subgraph Actions["Actions"]
        DB[DeliberateButton]
        SB[SubscribeButton]
        NDB[NewDiscussionButton]
    end
    
    subgraph Deliberation["Deliberation Bridge"]
        ENS["/api/deliberations/ensure"]
        DLM["/api/dialogue/move"]
    end
    
    DV --> Modes
    CM --> CR & MP
    FM --> FP & TLS
    DV --> Actions
    DB --> ENS
    ENS --> DLM
    DLM --> |"Creates"| DELIB[Deliberation]
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DISCUSSIONS SYSTEM                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Casual discussion before formal deliberation          â”‚
â”‚                                                                 â”‚
â”‚  TWO MODES:                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ’¬ CHAT   â”‚ Real-time messaging, quick exchanges          â”‚ â”‚
â”‚  â”‚ ğŸ“‹ FORUM  â”‚ Threaded comments, structured discussion      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  KEY COMPONENTS:                                                â”‚
â”‚  â€¢ DiscussionView.tsx - Main container with mode toggle        â”‚
â”‚  â€¢ ForumPane.tsx - Forum thread display                        â”‚
â”‚  â€¢ ChatRoom.tsx - Real-time chat interface                     â”‚
â”‚  â€¢ DeliberateButton.tsx - Bridge to formal deliberation        â”‚
â”‚                                                                 â”‚
â”‚  DELIBERATE FLOW:                                               â”‚
â”‚  Discussion â†’ [Deliberate] â†’ /api/deliberations/ensure          â”‚
â”‚            â†’ Creates Deliberation â†’ Opens DeepDivePanelV2       â”‚
â”‚                                                                 â”‚
â”‚  FILE LOCATIONS:                                                â”‚
â”‚  â€¢ components/discussion/DiscussionView.tsx                    â”‚
â”‚  â€¢ components/discussion/ForumPane.tsx                         â”‚
â”‚  â€¢ components/common/DeliberationButton.tsx                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="discussion-%E2%86%92-deliberation-flow">Discussion â†’ Deliberation Flow</h2>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant U as User
    participant DV as DiscussionView
    participant DB as DeliberateButton
    participant API as Backend API
    participant DP as DeepDivePanelV2
    
    U->>DV: Views discussion
    U->>DV: Clicks "Deliberate"
    DV->>DB: Trigger
    DB->>API: POST /api/deliberations/ensure<br/>{hostType: "discussion", hostId}
    
    alt Deliberation exists
        API-->>DB: {id: existing_delib_id}
    else New deliberation
        API->>API: Create Deliberation
        API-->>DB: {id: new_delib_id}
    end
    
    opt Seed claim provided
        DB->>API: POST /api/dialogue/move<br/>{kind: ASSERT, payload: {text}}
    end
    
    DB->>API: POST /api/discussions/:id/deliberations<br/>{deliberationId}
    DB->>DP: Navigate to /deliberation/:id
    DP->>U: Show DeepDivePanelV2
</div></code></pre>
<hr>
<h1 id="4-argument-schemes-system">4. Argument Schemes System</h1>
<h2 id="overview">Overview</h2>
<p>The Argument Schemes system implements <strong>Walton-style argumentation schemes</strong> with critical questions. It provides a library of 60+ formal argument patterns that can be applied to arguments.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph SchemeSystem["Argument Scheme System"]
        SL[SchemeList.tsx<br/>Admin View]
        SC[SchemeCreator.tsx<br/>Create/Edit]
        SHV[SchemeHierarchyView.tsx<br/>Tree View]
    end
    
    subgraph ArgumentIntegration["Argument Integration"]
        ASL[ArgumentSchemeList.tsx]
        ASC[AIFArgumentWithSchemeComposer.tsx]
        SB[SchemeBreakdown.tsx]
        SS[SchemeSelector.tsx]
        MSB[MultiSchemeBadge.tsx]
    end
    
    subgraph CriticalQuestions["Critical Questions"]
        CQM[ArgumentCriticalQuestionsModal.tsx]
        CQV[CriticalQuestionsV3.tsx]
        CQR[CQResponseForm.tsx]
    end
    
    subgraph SchemeData["Scheme Data Model"]
        AS["ArgumentScheme:<br/>â€¢ key, name<br/>â€¢ premises[], conclusion<br/>â€¢ materialRelation<br/>â€¢ reasoningType"]
        CQ["CriticalQuestion:<br/>â€¢ cqKey, text<br/>â€¢ attackType<br/>â€¢ targetScope<br/>â€¢ burdenOfProof"]
    end
    
    subgraph API["API Endpoints"]
        SCH["/api/schemes"]
        ASCH["/api/aif/schemes"]
        INST["/api/schemes/instances"]
    end
    
    SL --> SC & SHV
    SL --> API
    ASC --> SS --> AS
    AS --> CQ
    ASL --> MSB
    CQM --> CQV --> CQR
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ARGUMENT SCHEMES SYSTEM                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Formal argument patterns with critical questions      â”‚
â”‚                                                                 â”‚
â”‚  SCHEME STRUCTURE:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Scheme: &quot;Argument from Expert Opinion&quot;                    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ Premises:                                                 â”‚ â”‚
â”‚  â”‚   â€¢ E is an expert in domain D                           â”‚ â”‚
â”‚  â”‚   â€¢ E asserts A                                          â”‚ â”‚
â”‚  â”‚   â€¢ A is in domain D                                     â”‚ â”‚
â”‚  â”‚ Conclusion:                                               â”‚ â”‚
â”‚  â”‚   â€¢ A is (presumably) true                               â”‚ â”‚
â”‚  â”‚ Critical Questions:                                       â”‚ â”‚
â”‚  â”‚   CQ1: Is E credible?                                    â”‚ â”‚
â”‚  â”‚   CQ2: Is E expert in D?                                 â”‚ â”‚
â”‚  â”‚   CQ3: What did E actually say?                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  ATTACK TYPES (via CQs):                                        â”‚
â”‚  â€¢ REBUTS: Attacks conclusion                                  â”‚
â”‚  â€¢ UNDERCUTS: Attacks inference                                â”‚
â”‚  â€¢ UNDERMINES: Attacks premise                                 â”‚
â”‚                                                                 â”‚
â”‚  SCHEME CATEGORIES:                                             â”‚
â”‚  â€¢ Source-based (expert, witness, authority)                   â”‚
â”‚  â€¢ Causal (cause-effect, sign, correlation)                    â”‚
â”‚  â€¢ Analogy (comparison, precedent)                             â”‚
â”‚  â€¢ Practical (goals, consequences, values)                     â”‚
â”‚                                                                 â”‚
â”‚  KEY FILES:                                                     â”‚
â”‚  â€¢ components/admin/SchemeList.tsx                             â”‚
â”‚  â€¢ components/admin/SchemeCreator.tsx                          â”‚
â”‚  â€¢ components/arguments/ArgumentSchemeList.tsx                 â”‚
â”‚  â€¢ components/arguments/SchemeBreakdown.tsx                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="scheme-data-model">Scheme Data Model</h2>
<pre class="hljs"><code><div><span class="hljs-keyword">type</span> ArgumentScheme = {
  id: <span class="hljs-built_in">string</span>;
  key: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// e.g., "expert_opinion"</span>
  name: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// "Argument from Expert Opinion"</span>
  summary: <span class="hljs-built_in">string</span>;
  description?: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-comment">// Classification</span>
  materialRelation?: <span class="hljs-built_in">string</span>;  <span class="hljs-comment">// "source-based", "causal", etc.</span>
  reasoningType?: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// "presumptive", "deductive"</span>
  clusterTag?: <span class="hljs-built_in">string</span>;        <span class="hljs-comment">// Grouping tag</span>
  
  <span class="hljs-comment">// Structure</span>
  premises?: PremiseTemplate[];
  conclusion?: ConclusionTemplate;
  ruleForm?: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// Logical form</span>
  
  <span class="hljs-comment">// Hierarchy</span>
  parentSchemeId?: <span class="hljs-built_in">string</span>;
  inheritCQs?: <span class="hljs-built_in">boolean</span>;
  
  <span class="hljs-comment">// Critical Questions</span>
  cqs: CriticalQuestion[];
};

<span class="hljs-keyword">type</span> CriticalQuestion = {
  cqKey: <span class="hljs-built_in">string</span>;        <span class="hljs-comment">// e.g., "CQ1"</span>
  text: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// "Is E credible as an expert?"</span>
  attackType: <span class="hljs-string">'REBUTS'</span> | <span class="hljs-string">'UNDERCUTS'</span> | <span class="hljs-string">'UNDERMINES'</span>;
  targetScope: <span class="hljs-string">'conclusion'</span> | <span class="hljs-string">'inference'</span> | <span class="hljs-string">'premise'</span>;
  burdenOfProof?: <span class="hljs-string">'proponent'</span> | <span class="hljs-string">'challenger'</span>;
  requiresEvidence?: <span class="hljs-built_in">boolean</span>;
};
</div></code></pre>
<h2 id="scheme-hierarchy-visualization">Scheme Hierarchy Visualization</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SCHEME HIERARCHY                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“ Source-Based Arguments                                      â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Expert Opinion                           â”‚
â”‚  â”‚   â”œâ”€â”€ ğŸ“„ Argument from Expert Consensus                     â”‚
â”‚  â”‚   â””â”€â”€ ğŸ“„ Argument from Specialized Expert                   â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Witness Testimony                        â”‚
â”‚  â””â”€â”€ ğŸ“„ Argument from Authority                                â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ Causal Arguments                                            â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Cause to Effect                          â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Effect to Cause                          â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Sign                                     â”‚
â”‚  â””â”€â”€ ğŸ“„ Argument from Correlation to Cause                     â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ Practical Arguments                                         â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Consequences                             â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Goals                                    â”‚
â”‚  â””â”€â”€ ğŸ“„ Argument from Values                                   â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ Analogical Arguments                                        â”‚
â”‚  â”œâ”€â”€ ğŸ“„ Argument from Analogy                                  â”‚
â”‚  â””â”€â”€ ğŸ“„ Argument from Precedent                                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="5-thesis-system">5. Thesis System</h1>
<h2 id="overview">Overview</h2>
<p>The Thesis system allows users to compose <strong>structured legal-style documents</strong> that aggregate claims and arguments into cohesive, publishable theses with prongs, sections, and citations.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph ThesisSystem["Thesis System"]
        TC[ThesisComposer.tsx<br/>Create/Edit]
        TR[ThesisRenderer.tsx<br/>Read View]
        TLV[ThesisListView.tsx<br/>List]
        TE[ThesisEditor.tsx]
        TEM[ThesisExportModal.tsx]
    end
    
    subgraph Structure["Thesis Structure"]
        TH["Thesis:<br/>â€¢ title, abstract<br/>â€¢ status, template<br/>â€¢ thesisClaim"]
        PR["Prong:<br/>â€¢ order, title, role<br/>â€¢ mainClaim<br/>â€¢ arguments[]"]
        SEC["Section:<br/>â€¢ sectionType<br/>â€¢ title, content"]
    end
    
    subgraph ProngRoles["Prong Roles"]
        SUP[SUPPORT<br/>Supports thesis]
        REB[REBUT<br/>Addresses counter]
        PRE[PREEMPT<br/>Anticipates objection]
    end
    
    subgraph Templates["Templates"]
        LEG[LEGAL_DEFENSE]
        POL[POLICY_CASE]
        ACA[ACADEMIC_THESIS]
        GEN[GENERAL]
    end
    
    subgraph Sections["Section Types"]
        INT[INTRODUCTION]
        BG[BACKGROUND]
        LS[LEGAL_STANDARD]
        METH[METHODOLOGY]
        CON[CONCLUSION]
        APP[APPENDIX]
    end
    
    TC --> TH
    TH --> PR & SEC
    PR --> ProngRoles
    TC --> Templates
    SEC --> Sections
    TR --> |exports| TEM
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      THESIS SYSTEM                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Structured legal-style argument documents             â”‚
â”‚                                                                 â”‚
â”‚  THESIS STRUCTURE:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ THESIS                                                    â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ Title &amp; Abstract                                      â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ Thesis Claim (main assertion)                         â”‚ â”‚
â”‚  â”‚ â”œâ”€â”€ SECTIONS (intro, background, methodology...)          â”‚ â”‚
â”‚  â”‚ â””â”€â”€ PRONGS (supporting argument groups)                   â”‚ â”‚
â”‚  â”‚     â”œâ”€â”€ SUPPORT prong (positive case)                     â”‚ â”‚
â”‚  â”‚     â”œâ”€â”€ REBUT prong (counter arguments)                   â”‚ â”‚
â”‚  â”‚     â””â”€â”€ PREEMPT prong (anticipate objections)             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  TEMPLATES:                                                     â”‚
â”‚  â€¢ LEGAL_DEFENSE: Court brief style                            â”‚
â”‚  â€¢ POLICY_CASE: Policy proposal format                         â”‚
â”‚  â€¢ ACADEMIC_THESIS: Research paper structure                   â”‚
â”‚  â€¢ GENERAL: Flexible format                                    â”‚
â”‚                                                                 â”‚
â”‚  STATUS WORKFLOW:                                               â”‚
â”‚  DRAFT â†’ SUBMITTED â†’ PUBLISHED â†’ ARCHIVED                       â”‚
â”‚                                                                 â”‚
â”‚  KEY FILES:                                                     â”‚
â”‚  â€¢ components/thesis/ThesisComposer.tsx (~923 lines)           â”‚
â”‚  â€¢ components/thesis/ThesisRenderer.tsx                        â”‚
â”‚  â€¢ components/thesis/ProngEditor.tsx                           â”‚
â”‚  â€¢ components/thesis/ThesisSectionEditor.tsx                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="thesis-structure-diagram">Thesis Structure Diagram</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THESIS DOCUMENT                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘ TITLE: &quot;Analysis of Climate Policy Effectiveness&quot;         â•‘ â”‚
â”‚  â•‘ STATUS: ğŸ“ DRAFT                                           â•‘ â”‚
â”‚  â•‘ TEMPLATE: POLICY_CASE                                      â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“ ABSTRACT                                              â”‚   â”‚
â”‚  â”‚ &quot;This thesis argues that carbon taxation...&quot;             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ¯ THESIS CLAIM                                          â”‚   â”‚
â”‚  â”‚ &quot;Carbon taxation is the most effective policy tool...&quot;   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SECTIONS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“– INTRODUCTION                                          â”‚   â”‚
â”‚  â”‚ Background context and motivation...                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“š BACKGROUND                                            â”‚   â”‚
â”‚  â”‚ Historical context and prior work...                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PRONGS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ… PRONG 1: SUPPORT                                      â”‚   â”‚
â”‚  â”‚ &quot;Economic Effectiveness&quot;                                 â”‚   â”‚
â”‚  â”‚ Main Claim: Carbon taxes reduce emissions cost-effectivelyâ”‚   â”‚
â”‚  â”‚ Arguments:                                               â”‚   â”‚
â”‚  â”‚   [1] From Expert Consensus                             â”‚   â”‚
â”‚  â”‚   [2] From Statistical Evidence                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âš”ï¸ PRONG 2: REBUT                                        â”‚   â”‚
â”‚  â”‚ &quot;Addressing Economic Concerns&quot;                           â”‚   â”‚
â”‚  â”‚ Main Claim: Economic harms are overstated               â”‚   â”‚
â”‚  â”‚ Arguments:                                               â”‚   â”‚
â”‚  â”‚   [1] Against regressive impact claim                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="6-kb-wikis-system">6. KB Wikis System</h1>
<h2 id="overview">Overview</h2>
<p>KB (Knowledge Base) Wikis provide a <strong>block-based document system</strong> for creating wiki pages that can embed arguments, claims, room summaries, and transports from the deliberation system.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph KBSystem["KB Wiki System"]
        KPE[KbPageEditor.tsx<br/>Main Editor]
        KBR[KbBlockRenderer.tsx<br/>Block Display]
        KTR[KbTranscludeRenderer.tsx<br/>Embedded Content]
    end
    
    subgraph Blocks["Block Types"]
        TB[TextBlock]
        AB[ArgumentBlock]
        CB[ClaimBlock]
        RSB[RoomSummaryBlock]
        SHB[SheetBlock]
        TRB[TransportBlock]
    end
    
    subgraph Editor["Editor Features"]
        DND["Drag & Drop<br/>(dnd-kit)"]
        SM["Slash Menu<br/>Insert Picker"]
        SN["Snapshots<br/>Version History"]
    end
    
    subgraph Integration["Deliberation Integration"]
        EP[EntityPicker.tsx]
        TC[TransportComposer.tsx]
        PC[ProvenanceChip.tsx]
    end
    
    KPE --> KBR
    KBR --> Blocks
    KPE --> Editor
    Blocks --> Integration
    TB --> |"/argument"| AB
    TB --> |"/claim"| CB
    EP --> |selects| AB & CB & RSB
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      KB WIKI SYSTEM                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Block-based wiki with embedded deliberation content   â”‚
â”‚                                                                 â”‚
â”‚  BLOCK TYPES:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“ TextBlock      â”‚ Rich text content                     â”‚ â”‚
â”‚  â”‚ ğŸ’¬ ArgumentBlock  â”‚ Embedded argument from deliberation   â”‚ â”‚
â”‚  â”‚ ğŸ“Œ ClaimBlock     â”‚ Embedded claim with status            â”‚ â”‚
â”‚  â”‚ ğŸ  RoomSummaryBlockâ”‚ Deliberation room summary            â”‚ â”‚
â”‚  â”‚ ğŸ“Š SheetBlock     â”‚ Embedded debate sheet                 â”‚ â”‚
â”‚  â”‚ ğŸš€ TransportBlock â”‚ Cross-room argument transport         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  EDITOR FEATURES:                                               â”‚
â”‚  â€¢ Drag &amp; drop reordering (dnd-kit)                            â”‚
â”‚  â€¢ Slash commands (/argument, /claim, etc.)                    â”‚
â”‚  â€¢ Snapshot versioning                                         â”‚
â”‚  â€¢ Live/Draft block status                                     â”‚
â”‚                                                                 â”‚
â”‚  TRANSCLUSION:                                                  â”‚
â”‚  â€¢ Arguments render with full AIF structure                    â”‚
â”‚  â€¢ Claims show current status (IN/OUT/UNDEC)                   â”‚
â”‚  â€¢ Provenance chips show source deliberation                   â”‚
â”‚                                                                 â”‚
â”‚  KEY FILES:                                                     â”‚
â”‚  â€¢ components/kb/KbPageEditor.tsx                              â”‚
â”‚  â€¢ components/kb/KbBlockRenderer.tsx                           â”‚
â”‚  â€¢ components/kb/blocks/*.tsx                                  â”‚
â”‚  â€¢ components/kb/editor/plugins/SlashMenu.ts                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="block-structure">Block Structure</h2>
<pre class="hljs"><code><div><span class="hljs-keyword">type</span> KbBlock = {
  id: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">type</span>: BlockType;
  order: <span class="hljs-built_in">number</span>;
  live: <span class="hljs-built_in">boolean</span>;      <span class="hljs-comment">// Published or draft</span>
  data: BlockData;    <span class="hljs-comment">// Type-specific data</span>
};

<span class="hljs-keyword">type</span> BlockType = 
  | <span class="hljs-string">'text'</span>           <span class="hljs-comment">// Rich text</span>
  | <span class="hljs-string">'argument'</span>       <span class="hljs-comment">// ArgumentBlock</span>
  | <span class="hljs-string">'claim'</span>          <span class="hljs-comment">// ClaimBlock</span>
  | <span class="hljs-string">'room_summary'</span>   <span class="hljs-comment">// RoomSummaryBlock</span>
  | <span class="hljs-string">'sheet'</span>          <span class="hljs-comment">// SheetBlock</span>
  | <span class="hljs-string">'transport'</span>;     <span class="hljs-comment">// TransportBlock</span>

<span class="hljs-comment">// Example ArgumentBlock data</span>
<span class="hljs-keyword">type</span> ArgumentBlockData = {
  argumentId: <span class="hljs-built_in">string</span>;
  deliberationId: <span class="hljs-built_in">string</span>;
  showCQs?: <span class="hljs-built_in">boolean</span>;
  showDiagram?: <span class="hljs-built_in">boolean</span>;
};
</div></code></pre>
<hr>
<h1 id="7-discourse-dashboard">7. Discourse Dashboard</h1>
<h2 id="overview">Overview</h2>
<p>The Discourse Dashboard is a <strong>personal activity tracker</strong> showing users their contributions, engagements, and actions taken on their work across deliberations.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph Dashboard["Discourse Dashboard"]
        DD[DiscourseDashboard.tsx<br/>~1032 lines]
    end
    
    subgraph Tabs["Four Main Tabs"]
        CONT["My Contributions<br/>ğŸ“ What I created"]
        ENG["My Engagements<br/>ğŸ’¬ What I interacted with"]
        ACT["Actions on My Work<br/>ğŸ¯ Others' reactions"]
        FEED["Activity Feed<br/>ğŸ“Š Timeline"]
    end
    
    subgraph ContributionTypes["Contribution Types"]
        CL[Claims]
        AR[Arguments]
        PR[Propositions]
    end
    
    subgraph EngagementTypes["Engagement Types"]
        ATT[Attacks Made]
        SUP[Supports Given]
        CQ[CQs Asked]
        RES[Responses Given]
    end
    
    subgraph ActionTypes["Actions on My Work"]
        REC[Attacks Received]
        CHQ[Challenges Received]
        END[Endorsements]
        REF[Refutations]
    end
    
    DD --> Tabs
    CONT --> ContributionTypes
    ENG --> EngagementTypes
    ACT --> ActionTypes
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DISCOURSE DASHBOARD                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Track personal participation and engagement           â”‚
â”‚                                                                 â”‚
â”‚  TABS:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“ MY CONTRIBUTIONS                                       â”‚ â”‚
â”‚  â”‚    â€¢ Claims I've asserted                                 â”‚ â”‚
â”‚  â”‚    â€¢ Arguments I've constructed                           â”‚ â”‚
â”‚  â”‚    â€¢ Propositions I've submitted                          â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸ’¬ MY ENGAGEMENTS                                         â”‚ â”‚
â”‚  â”‚    â€¢ Attacks I've made                                    â”‚ â”‚
â”‚  â”‚    â€¢ Supports I've provided                               â”‚ â”‚
â”‚  â”‚    â€¢ Critical questions I've asked                        â”‚ â”‚
â”‚  â”‚    â€¢ Responses I've given                                 â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸ¯ ACTIONS ON MY WORK                                     â”‚ â”‚
â”‚  â”‚    â€¢ Attacks received on my claims                        â”‚ â”‚
â”‚  â”‚    â€¢ Challenges to my arguments                           â”‚ â”‚
â”‚  â”‚    â€¢ Endorsements received                                â”‚ â”‚
â”‚  â”‚    â€¢ Needs attention (pending responses)                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸ“Š ACTIVITY FEED                                          â”‚ â”‚
â”‚  â”‚    â€¢ Chronological timeline                               â”‚ â”‚
â”‚  â”‚    â€¢ All interactions in one view                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  ACTIONS:                                                       â”‚
â”‚  â€¢ Click to view detail                                        â”‚
â”‚  â€¢ Respond to attacks directly                                 â”‚
â”‚  â€¢ Track notification badges                                   â”‚
â”‚                                                                 â”‚
â”‚  FILE: components/discourse/DiscourseDashboard.tsx             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="dashboard-visualization">Dashboard Visualization</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DISCOURSE DASHBOARD                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [My Contributions] [My Engagements] [Actions on Me] [Feed]     â”‚
â”‚       â•â•â•â•â•â•â•                                                    â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ SUB-TABS: [All] [Claims] [Arguments] [Propositions]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“Š Summary: 12 Claims | 5 Arguments | 3 Propositions          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“Œ Claim: &quot;Carbon taxes reduce emissions&quot;               â”‚   â”‚
â”‚  â”‚    Status: ğŸŸ¢ IN | Supports: 3 | Attacks: 1              â”‚   â”‚
â”‚  â”‚    Created: 2 days ago                                   â”‚   â”‚
â”‚  â”‚    [View] [Respond to Attack]                           â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ’¬ Argument: &quot;From Expert Consensus&quot;                    â”‚   â”‚
â”‚  â”‚    Scheme: expert_opinion | CQs Answered: 2/6           â”‚   â”‚
â”‚  â”‚    Status: Active                                        â”‚   â”‚
â”‚  â”‚    [View] [Add Response]                                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ“ Proposition: &quot;We should implement carbon tax&quot;        â”‚   â”‚
â”‚  â”‚    Votes: 12 | Comments: 5                              â”‚   â”‚
â”‚  â”‚    [View Discussion]                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="8-evidence--sources--citations">8. Evidence / Sources / Citations</h1>
<h2 id="overview">Overview</h2>
<p>The Evidence system tracks <strong>sources and citations</strong> used across arguments and claims, with community quality ratings and usage metrics.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph EvidenceSystem["Evidence System"]
        EL[EvidenceList.tsx<br/>Source List View]
        SB[SupportBar.tsx<br/>Confidence Display]
        CC[ClaimConfidence.tsx]
        EMT[EvalModeToggle.tsx]
    end
    
    subgraph SourceData["Source Data Model"]
        ES["EvidenceSource:<br/>â€¢ title, url, type<br/>â€¢ authors, year<br/>â€¢ doi, publication"]
        UM["Usage Metrics:<br/>â€¢ usageCount<br/>â€¢ usedInArguments<br/>â€¢ usedInClaims<br/>â€¢ uniqueUsers"]
        RT["Ratings:<br/>â€¢ averageRating (1-10)<br/>â€¢ ratingCount"]
    end
    
    subgraph Features["Features"]
        SR["Source Rating<br/>(1-10 scale)"]
        US["Usage Stats"]
        FT["Filtering/Sorting"]
    end
    
    subgraph Integration["Integration Points"]
        ARG["Arguments<br/>(evidence claims)"]
        CIT["Citations<br/>(in thesis/KB)"]
        CL["Claims<br/>(supporting evidence)"]
    end
    
    EL --> SourceData
    EL --> Features
    SourceData --> Integration
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  EVIDENCE / SOURCES SYSTEM                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Track citations and rate source quality               â”‚
â”‚                                                                 â”‚
â”‚  SOURCE DATA:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â€¢ title: &quot;Study on Carbon Tax Effectiveness&quot;             â”‚ â”‚
â”‚  â”‚ â€¢ url: https://journal.org/article/123                   â”‚ â”‚
â”‚  â”‚ â€¢ type: academic_paper | news | report | book            â”‚ â”‚
â”‚  â”‚ â€¢ authors: [{family: &quot;Smith&quot;, given: &quot;J&quot;}]               â”‚ â”‚
â”‚  â”‚ â€¢ year: 2023                                             â”‚ â”‚
â”‚  â”‚ â€¢ doi: 10.1234/example                                   â”‚ â”‚
â”‚  â”‚ â€¢ publication: &quot;Climate Policy Journal&quot;                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  METRICS:                                                       â”‚
â”‚  â€¢ Usage count: Times cited                                    â”‚
â”‚  â€¢ Used in: X arguments, Y claims                              â”‚
â”‚  â€¢ Unique users: Z different people cited this                 â”‚
â”‚  â€¢ Average rating: 8.5/10 (N ratings)                          â”‚
â”‚                                                                 â”‚
â”‚  RATING SYSTEM:                                                 â”‚
â”‚  â€¢ Community rates 1-10 scale                                  â”‚
â”‚  â€¢ Higher = more reliable/trustworthy                          â”‚
â”‚  â€¢ Ratings inform confidence calculations                      â”‚
â”‚                                                                 â”‚
â”‚  KEY FILES:                                                     â”‚
â”‚  â€¢ components/evidence/EvidenceList.tsx                        â”‚
â”‚  â€¢ components/evidence/SupportBar.tsx                          â”‚
â”‚  â€¢ app/api/deliberations/[id]/sources/route.ts                 â”‚
â”‚  â€¢ app/api/sources/[id]/rate/route.ts                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="source-data-model">Source Data Model</h2>
<pre class="hljs"><code><div><span class="hljs-keyword">type</span> EvidenceSource = {
  sourceId: <span class="hljs-built_in">string</span>;
  title: <span class="hljs-built_in">string</span>;
  url: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">type</span>: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// academic_paper, news, report, etc.</span>
  authorsJson: <span class="hljs-built_in">any</span>;      <span class="hljs-comment">// Parsed author data</span>
  year: <span class="hljs-built_in">number</span> | <span class="hljs-literal">null</span>;
  publicationTitle: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  doi: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span>;
  
  <span class="hljs-comment">// Usage metrics</span>
  usageCount: <span class="hljs-built_in">number</span>;
  usedInArguments: <span class="hljs-built_in">number</span>;
  usedInClaims: <span class="hljs-built_in">number</span>;
  uniqueUsers: <span class="hljs-built_in">number</span>;
  firstUsed: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// ISO date</span>
  lastUsed: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// ISO date</span>
  
  <span class="hljs-comment">// Community rating</span>
  averageRating: <span class="hljs-built_in">number</span> | <span class="hljs-literal">null</span>;  <span class="hljs-comment">// 1-10 scale</span>
  ratingCount: <span class="hljs-built_in">number</span>;
};
</div></code></pre>
<hr>
<h1 id="9-stacks--libraries">9. Stacks &amp; Libraries</h1>
<h2 id="overview">Overview</h2>
<p>Stacks are <strong>curated collections</strong> of references, arguments, or resources that users can organize, share, and use across deliberations.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph StacksSystem["Stacks System"]
        SD[StacksDashboard.tsx<br/>User's Stacks]
        SP["Stack Page<br/>/stacks/[slugOrId]"]
    end
    
    subgraph StackData["Stack Data Model"]
        ST["Stack:<br/>â€¢ id, name, slug<br/>â€¢ is_public<br/>â€¢ description"]
        SI["Stack Items:<br/>â€¢ References<br/>â€¢ Arguments<br/>â€¢ Claims"]
    end
    
    subgraph Features["Features"]
        CR[Create Stack]
        ED[Edit/Rename]
        SH[Share (public/private)]
        CP[Copy Link]
        DL[Delete]
    end
    
    subgraph Integration["Integration"]
        DL2["Deliberations<br/>(stack_ref edges)"]
        PX["Plexus Network<br/>(cross-stack links)"]
        KB["KB Wikis<br/>(embed stacks)"]
    end
    
    SD --> StackData
    SD --> Features
    StackData --> Integration
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STACKS &amp; LIBRARIES                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Curated collections of resources and arguments        â”‚
â”‚                                                                 â”‚
â”‚  STACK PROPERTIES:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â€¢ name: &quot;Climate Policy Resources&quot;                        â”‚ â”‚
â”‚  â”‚ â€¢ slug: climate-policy-resources                          â”‚ â”‚
â”‚  â”‚ â€¢ is_public: true/false                                   â”‚ â”‚
â”‚  â”‚ â€¢ description: &quot;Collection of key papers...&quot;              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  FEATURES:                                                      â”‚
â”‚  â€¢ Create new stacks                                           â”‚
â”‚  â€¢ Add items (refs, arguments, claims)                         â”‚
â”‚  â€¢ Public/private visibility                                   â”‚
â”‚  â€¢ Share via slug URL                                          â”‚
â”‚  â€¢ Search and filter                                           â”‚
â”‚                                                                 â”‚
â”‚  INTEGRATION:                                                   â”‚
â”‚  â€¢ Plexus: stack_ref edge type                                 â”‚
â”‚  â€¢ KB Wikis: Embed stack blocks                                â”‚
â”‚  â€¢ Deliberations: Reference stack items                        â”‚
â”‚                                                                 â”‚
â”‚  KEY FILES:                                                     â”‚
â”‚  â€¢ app/(root)/(standard)/profile/stacks/ui/StacksDashboard.tsx â”‚
â”‚  â€¢ app/stacks/[slugOrId]/page.tsx                              â”‚
â”‚  â€¢ app/api/stacks/route.ts                                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="10-deliberate-button-flow">10. Deliberate Button Flow</h1>
<h2 id="overview">Overview</h2>
<p>The <strong>Deliberate Button</strong> is the bridge that transforms casual discussions into formal deliberations. It appears in discussions and creates/opens the corresponding deliberation.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph Triggers["Trigger Points"]
        DV[DiscussionView]
        CC[Comment Card]
        KB[KB Wiki Page]
    end
    
    subgraph Button["DeliberateButton"]
        DB[DeliberateButton.tsx]
        DBP["Props:<br/>â€¢ discussionId<br/>â€¢ conversationId?<br/>â€¢ seedClaimText?"]
    end
    
    subgraph Flow["Deliberation Flow"]
        ENS["/api/deliberations/ensure<br/>POST {hostType, hostId}"]
        CHK{Exists?}
        NEW[Create New Deliberation]
        GET[Return Existing ID]
        SEED["Optional: Seed Claim<br/>/api/dialogue/move"]
        LINK["Link to Discussion<br/>/api/discussions/:id/deliberations"]
        NAV["Navigate to<br/>/deliberation/:id"]
    end
    
    Triggers --> DB
    DB --> ENS
    ENS --> CHK
    CHK -->|No| NEW --> SEED
    CHK -->|Yes| GET
    NEW & GET --> LINK --> NAV
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DELIBERATE BUTTON                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Bridge from casual discussion to formal deliberation  â”‚
â”‚                                                                 â”‚
â”‚  PROPS:                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ discussionId   â”‚ Required â”‚ Source discussion ID          â”‚ â”‚
â”‚  â”‚ conversationId â”‚ Optional â”‚ Chat thread ID                â”‚ â”‚
â”‚  â”‚ seedClaimText  â”‚ Optional â”‚ Initial claim to assert       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  FLOW:                                                          â”‚
â”‚  1. User clicks &quot;Deliberate&quot; button                            â”‚
â”‚  2. POST /api/deliberations/ensure                             â”‚
â”‚     â€¢ hostType: &quot;discussion&quot; | &quot;inbox_thread&quot;                  â”‚
â”‚     â€¢ hostId: discussionId or conversationId                   â”‚
â”‚  3. If new, creates deliberation                               â”‚
â”‚  4. If seedClaimText, creates initial ASSERT move              â”‚
â”‚  5. Links deliberation back to discussion                      â”‚
â”‚  6. Redirects to /deliberation/:id                             â”‚
â”‚                                                                 â”‚
â”‚  HOST TYPES:                                                    â”‚
â”‚  â€¢ discussion: Forum discussion                                â”‚
â”‚  â€¢ inbox_thread: Chat conversation                             â”‚
â”‚  â€¢ article: Article/post                                       â”‚
â”‚  â€¢ kb_page: KB wiki page                                       â”‚
â”‚                                                                 â”‚
â”‚  KEY FILES:                                                     â”‚
â”‚  â€¢ components/common/DeliberationButton.tsx                    â”‚
â”‚  â€¢ components/discussion/DeliberateButton.tsx                  â”‚
â”‚  â€¢ app/api/deliberations/ensure/route.ts                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="complete-flow-sequence">Complete Flow Sequence</h2>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant U as User
    participant D as Discussion
    participant DB as DeliberateButton
    participant API as Backend
    participant DEL as Deliberation
    participant DDP as DeepDivePanelV2
    
    U->>D: Views discussion
    U->>DB: Clicks "Deliberate"
    DB->>DB: setBusy(true)
    
    DB->>API: POST /api/deliberations/ensure
    Note right of API: {hostType: "discussion",<br/>hostId: "disc-123"}
    
    alt No existing deliberation
        API->>DEL: Create new deliberation
        DEL-->>API: {id: "delib-456"}
    else Deliberation exists
        API-->>DB: {id: "existing-delib"}
    end
    
    opt seedClaimText provided
        DB->>API: POST /api/dialogue/move
        Note right of API: {deliberationId, kind: "ASSERT",<br/>payload: {text: seedClaimText}}
    end
    
    DB->>API: POST /api/discussions/:id/deliberations
    Note right of API: Links deliberation to discussion
    
    DB->>DDP: location.href = /deliberation/:id
    DDP->>U: DeepDivePanelV2 rendered
    
    DB->>DB: setBusy(false)
</div></code></pre>
<hr>
<h1 id="master-system-integration-diagram">Master System Integration Diagram</h1>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph EntryPoints["Entry Points"]
        DSC[Discussion]
        AGR[Agora Home]
        PLX[Plexus]
        KBP[KB Page]
    end
    
    subgraph Core["Core Deliberation"]
        DDP[DeepDivePanelV2]
        DB[Debate Sheet]
        ARG[Arguments]
        CL[Claims]
    end
    
    subgraph Support["Supporting Systems"]
        SCH[Schemes]
        TH[Thesis]
        KB[KB Wiki]
        STK[Stacks]
    end
    
    subgraph Analytics["Analytics & Tracking"]
        DD[Discourse Dashboard]
        EV[Evidence/Sources]
        PM[Plexus Metrics]
    end
    
    DSC -->|Deliberate| DDP
    AGR --> PLX --> DDP
    KBP -->|embed| DDP
    
    DDP --> DB & ARG & CL
    ARG --> SCH
    DDP --> TH
    KB --> |transclude| ARG & CL
    STK --> |reference| ARG
    
    DDP --> DD
    ARG --> EV
    PLX --> PM
</div></code></pre>
<hr>
<h2 id="file-location-quick-reference">File Location Quick Reference</h2>
<pre class="hljs"><code><div>DEBATE SHEETS:
â”œâ”€â”€ components/agora/DebateSheetReader.tsx
â”œâ”€â”€ components/deepdive/v3/debate-sheet/*
â””â”€â”€ components/evidence/SupportBar.tsx

PLEXUS:
â”œâ”€â”€ components/agora/Plexus.tsx
â”œâ”€â”€ components/agora/PlexusBoard.tsx
â”œâ”€â”€ components/agora/PlexusMatrix.tsx
â””â”€â”€ components/agora/PlexusRoomMetrics.tsx

DISCUSSIONS:
â”œâ”€â”€ components/discussion/DiscussionView.tsx
â”œâ”€â”€ components/discussion/ForumPane.tsx
â””â”€â”€ components/common/DeliberationButton.tsx

SCHEMES:
â”œâ”€â”€ components/admin/SchemeList.tsx
â”œâ”€â”€ components/admin/SchemeCreator.tsx
â”œâ”€â”€ components/arguments/ArgumentSchemeList.tsx
â””â”€â”€ components/arguments/SchemeBreakdown.tsx

THESIS:
â”œâ”€â”€ components/thesis/ThesisComposer.tsx
â”œâ”€â”€ components/thesis/ThesisRenderer.tsx
â”œâ”€â”€ components/thesis/ProngEditor.tsx
â””â”€â”€ components/thesis/ThesisSectionEditor.tsx

KB WIKIS:
â”œâ”€â”€ components/kb/KbPageEditor.tsx
â”œâ”€â”€ components/kb/KbBlockRenderer.tsx
â”œâ”€â”€ components/kb/blocks/*.tsx
â””â”€â”€ components/kb/editor/plugins/SlashMenu.ts

DISCOURSE DASHBOARD:
â””â”€â”€ components/discourse/DiscourseDashboard.tsx

EVIDENCE:
â”œâ”€â”€ components/evidence/EvidenceList.tsx
â”œâ”€â”€ components/evidence/SupportBar.tsx
â””â”€â”€ app/api/deliberations/[id]/sources/route.ts

STACKS:
â”œâ”€â”€ app/(root)/(standard)/profile/stacks/ui/StacksDashboard.tsx
â”œâ”€â”€ app/stacks/[slugOrId]/page.tsx
â””â”€â”€ app/api/stacks/route.ts
</div></code></pre>
<hr>
<h1 id="11-glossary--dictionary-system">11. Glossary / Dictionary System</h1>
<h2 id="overview">Overview</h2>
<p>The Glossary System enables <strong>collaborative term definition</strong> within deliberations to reduce semantic confusion. Participants can propose terms, provide competing definitions, vote on definitions, and track usage across arguments.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph GlossarySystem["Glossary System"]
        DS[DefinitionSheet.tsx<br/>Main Container]
        TC[TermCard.tsx<br/>Term Display]
        PTM[ProposeTermModal.tsx<br/>Create Terms]
        PAM[ProposeAlternativeModal.tsx<br/>Add Definitions]
    end
    
    subgraph TermData["Term Data Model"]
        GT["GlossaryTerm:<br/>â€¢ term, termNormalized<br/>â€¢ status (PENDING/CONSENSUS/<br/>  CONTESTED/ARCHIVED)<br/>â€¢ proposedById"]
        GD["GlossaryDefinition:<br/>â€¢ definition, examples<br/>â€¢ sources, isCanonical<br/>â€¢ endorsementCount"]
    end
    
    subgraph Voting["Voting & Endorsement"]
        EB[EndorseButton.tsx]
        GE["GlossaryEndorsement"]
        GDV["GlossaryDefinitionVote"]
    end
    
    subgraph Usage["Usage Tracking"]
        GTU["GlossaryTermUsage"]
        GTL[GlossaryTermLink.tsx]
        GT2[GlossaryText.tsx<br/>Auto-linking]
        VUM[ViewUsageModal.tsx]
    end
    
    subgraph History["History & Export"]
        GDH["GlossaryDefinitionHistory"]
        VHM[ViewHistoryModal.tsx]
        EGB[ExportGlossaryButton.tsx]
    end
    
    DS --> TC --> EB
    TC --> PAM
    DS --> PTM
    PTM --> GT --> GD
    GD --> Voting
    GD --> History
    GT --> Usage
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GLOSSARY / DICTIONARY                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Collaborative term definitions for shared vocabulary  â”‚
â”‚                                                                 â”‚
â”‚  TERM STATUS LIFECYCLE:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â³ PENDING    â”‚ Awaiting endorsements                     â”‚ â”‚
â”‚  â”‚ âœ… CONSENSUS  â”‚ One definition has sufficient support     â”‚ â”‚
â”‚  â”‚ âš¡ CONTESTED  â”‚ Multiple competing definitions            â”‚ â”‚
â”‚  â”‚ ğŸ“¦ ARCHIVED   â”‚ No longer active                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  FEATURES:                                                      â”‚
â”‚  â€¢ Propose new terms with definitions                          â”‚
â”‚  â€¢ Propose alternative definitions (competing views)           â”‚
â”‚  â€¢ Endorse definitions (community voting)                      â”‚
â”‚  â€¢ Track term usage across arguments                           â”‚
â”‚  â€¢ View definition history/audit trail                         â”‚
â”‚  â€¢ Export glossary to file                                     â”‚
â”‚  â€¢ Auto-link terms in text (GlossaryText component)            â”‚
â”‚                                                                 â”‚
â”‚  SORTING/FILTERING:                                             â”‚
â”‚  â€¢ Sort by: Most Used, Alphabetical, Recent                    â”‚
â”‚  â€¢ Filter by: Status (All/Consensus/Contested/Pending)         â”‚
â”‚                                                                 â”‚
â”‚  FILE LOCATIONS:                                                â”‚
â”‚  â€¢ components/glossary/DefinitionSheet.tsx (main container)    â”‚
â”‚  â€¢ components/glossary/TermCard.tsx (term display)             â”‚
â”‚  â€¢ components/glossary/ProposeTermModal.tsx (create terms)     â”‚
â”‚  â€¢ components/glossary/EndorseButton.tsx (voting)              â”‚
â”‚  â€¢ lib/glossary/parseGlossaryLinks.tsx (auto-linking)          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="data-model">Data Model</h2>
<pre class="hljs"><code><div><span class="hljs-comment">// Term Status</span>
<span class="hljs-keyword">enum</span> GlossaryTermStatus {
  PENDING    <span class="hljs-comment">// Awaiting endorsements</span>
  CONSENSUS  <span class="hljs-comment">// Sufficient endorsements for one definition</span>
  CONTESTED  <span class="hljs-comment">// Multiple competing definitions</span>
  ARCHIVED   <span class="hljs-comment">// No longer active</span>
}

<span class="hljs-comment">// Core Term Model</span>
<span class="hljs-keyword">type</span> GlossaryTerm = {
  id: <span class="hljs-built_in">string</span>;
  deliberationId: <span class="hljs-built_in">string</span>;
  term: <span class="hljs-built_in">string</span>;              <span class="hljs-comment">// "Justice"</span>
  termNormalized: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// "justice" (for matching)</span>
  status: GlossaryTermStatus;
  proposedById: <span class="hljs-built_in">string</span>;
  definitions: GlossaryDefinition[];
  usages: GlossaryTermUsage[];
};

<span class="hljs-comment">// Definition with voting</span>
<span class="hljs-keyword">type</span> GlossaryDefinition = {
  id: <span class="hljs-built_in">string</span>;
  termId: <span class="hljs-built_in">string</span>;
  definition: <span class="hljs-built_in">string</span>;        <span class="hljs-comment">// The actual text</span>
  examples?: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// Usage examples</span>
  sources?: <span class="hljs-built_in">any</span>;             <span class="hljs-comment">// Citations/references</span>
  authorId: <span class="hljs-built_in">string</span>;
  isCanonical: <span class="hljs-built_in">boolean</span>;      <span class="hljs-comment">// Consensus or moderator-endorsed</span>
  endorsementCount: <span class="hljs-built_in">number</span>;  <span class="hljs-comment">// Cached vote count</span>
  endorsements: GlossaryEndorsement[];
  votes: GlossaryDefinitionVote[];
  history: GlossaryDefinitionHistory[];
};

<span class="hljs-comment">// Voting records</span>
<span class="hljs-keyword">type</span> GlossaryEndorsement = {
  definitionId: <span class="hljs-built_in">string</span>;
  userId: <span class="hljs-built_in">string</span>;
};

<span class="hljs-keyword">type</span> GlossaryDefinitionVote = {
  definitionId: <span class="hljs-built_in">string</span>;
  userId: <span class="hljs-built_in">string</span>;
  value: <span class="hljs-built_in">number</span>;  <span class="hljs-comment">// +1 upvote, -1 downvote, 0 neutral</span>
};
</div></code></pre>
<h2 id="ui-flow-diagram">UI Flow Diagram</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DEFINITION SHEET                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Glossary â€¢ 12 terms            [Export] [+ Define Term] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  [ğŸ” Search...]  [Sort: Most Used â–¼]  [Filter: All â–¼]          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“— &quot;Justice&quot;                              âœ… CONSENSUS    â”‚  â”‚
â”‚  â”‚ âœ¨ Used 8 times in arguments                             â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚ CANONICAL DEFINITION:                                    â”‚  â”‚
â”‚  â”‚ &quot;The fair and equitable treatment of all parties...&quot;     â”‚  â”‚
â”‚  â”‚ â€” proposed by @user1                                     â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚ [ğŸ‘ 12 Endorse] [ğŸ“œ History] [â• Alternative] [ğŸ‘ï¸ Usage] â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚ â–¼ 2 COMPETING DEFINITIONS                                â”‚  â”‚
â”‚  â”‚   â€¢ &quot;Justice means retribution...&quot; [ğŸ‘ 3]                â”‚  â”‚
â”‚  â”‚   â€¢ &quot;Justice is restorative...&quot; [ğŸ‘ 5]                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“™ &quot;Liberty&quot;                               âš¡ CONTESTED   â”‚  â”‚
â”‚  â”‚ âœ¨ Used 3 times in arguments                             â”‚  â”‚
â”‚  â”‚ (3 competing definitions, no consensus yet)              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="12-issues-system">12. Issues System</h1>
<h2 id="overview">Overview</h2>
<p>The Issues System provides a <strong>structured tracking mechanism</strong> for questions, clarifications, reviews, and action items within deliberations. It supports the &quot;Request Clarification&quot; button flow and community defense (NCM) reviews.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph IssueSystem["Issues System"]
        IL[IssuesList.tsx<br/>List View]
        ID[IssueDetail.tsx<br/>Detail Modal]
        IC[IssueComposer.tsx<br/>Create Issues]
        ICE[IssueComposerExtended.tsx<br/>Extended Creator]
    end
    
    subgraph IssueKinds["Issue Kinds"]
        GEN["general: Generic issue"]
        CQ["cq: Critical question"]
        MOD["moderation: Content moderation"]
        EVD["evidence: Evidence request"]
        STR["structural: Structural issue"]
        GOV["governance: Governance matter"]
        CLR["clarification: Q&A request"]
        NCM["community_defense: NCM review"]
    end
    
    subgraph ClarificationFlow["Clarification Flow"]
        CRB[ClarificationRequestButton.tsx]
        QTEXT["questionText: The question"]
        ATEXT["answerText: The answer"]
    end
    
    subgraph NCMFlow["NCM Review Flow"]
        NCMR[NCMReviewCard.tsx]
        MID[MyIssuesDashboard.tsx]
        NCMS["NCM Status:<br/>PENDING â†’ APPROVED/REJECTED"]
    end
    
    subgraph IssueLinks["Issue Links"]
        IL2["IssueLink:<br/>â€¢ targetType (argument/claim/card)<br/>â€¢ targetId<br/>â€¢ role (related/blocks/depends_on)"]
        IEP[IssueEntityPicker.tsx]
    end
    
    IL --> ID
    ID --> IC & ICE
    CRB --> ICE
    ID --> NCMR
    IC --> IssueKinds
    ID --> IssueLinks
    IEP --> IL2
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ISSUES SYSTEM                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Track questions, reviews, and action items            â”‚
â”‚                                                                 â”‚
â”‚  ISSUE KINDS:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“ general          â”‚ Generic issue                       â”‚ â”‚
â”‚  â”‚ â“ cq               â”‚ Critical question tracking          â”‚ â”‚
â”‚  â”‚ ğŸ›¡ï¸ moderation       â”‚ Content moderation                  â”‚ â”‚
â”‚  â”‚ ğŸ“Š evidence         â”‚ Evidence request                    â”‚ â”‚
â”‚  â”‚ ğŸ—ï¸ structural       â”‚ Structural argument issue           â”‚ â”‚
â”‚  â”‚ âš–ï¸ governance       â”‚ Governance/policy matter            â”‚ â”‚
â”‚  â”‚ ğŸ’¬ clarification    â”‚ Request clarification (Q&amp;A)         â”‚ â”‚
â”‚  â”‚ ğŸ›¡ï¸ community_defenseâ”‚ NCM (non-canonical move) review     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  ISSUE STATES:                                                  â”‚
â”‚  â€¢ open: Active, needs attention                               â”‚
â”‚  â€¢ pending: Assigned, being worked on                          â”‚
â”‚  â€¢ closed: Resolved                                            â”‚
â”‚                                                                 â”‚
â”‚  CLARIFICATION FLOW:                                            â”‚
â”‚  1. User clicks &quot;Request Clarification&quot; on argument/claim      â”‚
â”‚  2. Issue created with kind=clarification                      â”‚
â”‚  3. Author sees in &quot;My Issues&quot; dashboard                       â”‚
â”‚  4. Author provides answerText                                 â”‚
â”‚  5. Issue closes with answer displayed                         â”‚
â”‚                                                                 â”‚
â”‚  NCM REVIEW FLOW:                                               â”‚
â”‚  1. Community member submits defense for argument              â”‚
â”‚  2. Issue created with kind=community_defense                  â”‚
â”‚  3. Author reviews via NCMReviewCard                           â”‚
â”‚  4. Author approves/rejects with notes                         â”‚
â”‚  5. If approved, NCM content integrated                        â”‚
â”‚                                                                 â”‚
â”‚  FILE LOCATIONS:                                                â”‚
â”‚  â€¢ components/issues/IssuesList.tsx                            â”‚
â”‚  â€¢ components/issues/IssueDetail.tsx                           â”‚
â”‚  â€¢ components/issues/ClarificationRequestButton.tsx            â”‚
â”‚  â€¢ components/issues/NCMReviewCard.tsx                         â”‚
â”‚  â€¢ components/issues/MyIssuesDashboard.tsx                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="data-model">Data Model</h2>
<pre class="hljs"><code><div><span class="hljs-comment">// Issue States</span>
<span class="hljs-keyword">enum</span> IssueState {
  open     <span class="hljs-comment">// Active, needs attention</span>
  pending  <span class="hljs-comment">// Assigned, being worked on</span>
  closed   <span class="hljs-comment">// Resolved</span>
}

<span class="hljs-comment">// Issue Kinds (categories)</span>
<span class="hljs-keyword">enum</span> IssueKind {
  general           <span class="hljs-comment">// Generic</span>
  cq                <span class="hljs-comment">// Critical question</span>
  moderation        <span class="hljs-comment">// Content moderation</span>
  evidence          <span class="hljs-comment">// Evidence request</span>
  structural        <span class="hljs-comment">// Structural issue</span>
  governance        <span class="hljs-comment">// Governance matter</span>
  clarification     <span class="hljs-comment">// Q&amp;A request (Request Clarification button)</span>
  community_defense <span class="hljs-comment">// NCM review</span>
}

<span class="hljs-comment">// Link Target Types</span>
<span class="hljs-keyword">enum</span> IssueLinkTargetType {
  argument
  claim
  card
  inference
}

<span class="hljs-comment">// Link Roles</span>
<span class="hljs-keyword">enum</span> IssueLinkRole {
  related     <span class="hljs-comment">// General relation</span>
  blocks      <span class="hljs-comment">// This issue blocks the target</span>
  depends_on  <span class="hljs-comment">// Issue depends on target resolution</span>
  warrant     <span class="hljs-comment">// Related to warrant/inference</span>
  evidence    <span class="hljs-comment">// Related to evidence</span>
}

<span class="hljs-comment">// Core Issue Model</span>
<span class="hljs-keyword">type</span> Issue = {
  id: <span class="hljs-built_in">string</span>;
  deliberationId: <span class="hljs-built_in">string</span>;
  label: <span class="hljs-built_in">string</span>;
  description?: <span class="hljs-built_in">string</span>;
  state: IssueState;
  kind: IssueKind;
  
  <span class="hljs-comment">// Creator/Assignment</span>
  createdById: <span class="hljs-built_in">string</span>;
  assigneeId?: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-comment">// Clarification-specific fields</span>
  questionText?: <span class="hljs-built_in">string</span>;   <span class="hljs-comment">// The actual question</span>
  answerText?: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// Author's answer</span>
  answeredAt?: <span class="hljs-built_in">Date</span>;
  answeredById?: <span class="hljs-built_in">string</span>;
  
  <span class="hljs-comment">// NCM Review fields</span>
  ncmId?: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// Link to NonCanonicalMove</span>
  ncmStatus?: NCMStatus;   <span class="hljs-comment">// PENDING/APPROVED/REJECTED/EXECUTED</span>
  reviewedAt?: <span class="hljs-built_in">Date</span>;
  reviewNotes?: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// Author's review notes</span>
  
  <span class="hljs-comment">// Relations</span>
  links: IssueLink[];
};

<span class="hljs-comment">// Issue Links (polymorphic targets)</span>
<span class="hljs-keyword">type</span> IssueLink = {
  id: <span class="hljs-built_in">string</span>;
  issueId: <span class="hljs-built_in">string</span>;
  targetType: IssueLinkTargetType;
  targetId: <span class="hljs-built_in">string</span>;
  role?: IssueLinkRole;
};
</div></code></pre>
<h2 id="clarification-request-flow">Clarification Request Flow</h2>
<pre><code class="language-mermaid"><div class="mermaid">sequenceDiagram
    participant U as User
    participant CRB as ClarificationRequestButton
    participant API as Backend API
    participant AU as Author
    participant MID as MyIssuesDashboard
    
    U->>CRB: Clicks "Request Clarification"
    Note right of CRB: On argument or claim
    CRB->>API: POST /api/deliberations/:id/issues
    Note right of API: kind: "clarification"<br/>questionText: "What do you mean by..."
    API-->>CRB: {issue: {id}}
    
    CRB->>CRB: Dispatch issues:refresh event
    
    AU->>MID: Opens "My Issues" dashboard
    MID->>API: GET /api/deliberations/:id/issues?assigneeId=author
    API-->>MID: [issues with kind=clarification]
    
    AU->>API: PATCH /api/deliberations/:id/issues/:id
    Note right of API: answerText: "I meant..."<br/>state: "closed"
    API-->>AU: {ok: true}
    
    API->>API: Notify original user
    U->>U: Sees answer on issue
</div></code></pre>
<h2 id="ncm-community-defense-flow">NCM Community Defense Flow</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  NCM REVIEW FLOW                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. COMMUNITY MEMBER SUBMITS DEFENSE                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ ğŸ›¡ï¸ NonCanonicalMove                                 â”‚    â”‚
â”‚     â”‚ targetType: argument                                â”‚    â”‚
â”‚     â”‚ moveType: GROUNDS_RESPONSE                          â”‚    â”‚
â”‚     â”‚ content: { expression: &quot;Supporting evidence...&quot; }   â”‚    â”‚
â”‚     â”‚ status: PENDING                                     â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â†“                                     â”‚
â”‚  2. ISSUE CREATED AUTOMATICALLY                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ ğŸ“‹ Issue                                            â”‚    â”‚
â”‚     â”‚ kind: community_defense                             â”‚    â”‚
â”‚     â”‚ ncmId: [link to NCM]                                â”‚    â”‚
â”‚     â”‚ assigned to: argument author                        â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â†“                                     â”‚
â”‚  3. AUTHOR REVIEWS                                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚     â”‚ NCMReviewCard                                       â”‚    â”‚
â”‚     â”‚ Shows: contributor, moveType, content               â”‚    â”‚
â”‚     â”‚ Actions: [âœ… Approve] [âŒ Reject]                    â”‚    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â†“                                     â”‚
â”‚  4. OUTCOME                                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚     â”‚ âœ… APPROVED      â”‚   â”‚ âŒ REJECTED                â”‚      â”‚
â”‚     â”‚ NCM â†’ EXECUTED   â”‚   â”‚ NCM â†’ REJECTED             â”‚      â”‚
â”‚     â”‚ Content merged   â”‚   â”‚ Notes provided to contrib  â”‚      â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h1 id="13-scheme-admin-system">13. Scheme Admin System</h1>
<h2 id="overview">Overview</h2>
<p>The Scheme Admin system provides a <strong>comprehensive interface</strong> for managing argumentation schemes, including creation, editing, taxonomy classification, critical question management, and scheme hierarchy visualization.</p>
<h2 id="architecture-diagram">Architecture Diagram</h2>
<pre><code class="language-mermaid"><div class="mermaid">flowchart TB
    subgraph AdminPage["Admin Page"]
        ASP["/admin/schemes<br/>page.tsx"]
    end
    
    subgraph SchemeListView["Scheme List View"]
        SL[SchemeList.tsx<br/>Main Component]
        VM["View Modes:<br/>â€¢ List view<br/>â€¢ Hierarchy view"]
        FLT["Filters:<br/>â€¢ Search query<br/>â€¢ Material relation"]
    end
    
    subgraph SchemeCreator["Scheme Creator"]
        SC[SchemeCreator.tsx<br/>~1239 lines]
        BIF["Basic Info:<br/>â€¢ key, name<br/>â€¢ summary, description"]
        TAX["Taxonomy (Macagno):<br/>â€¢ purpose, source<br/>â€¢ materialRelation<br/>â€¢ reasoningType<br/>â€¢ ruleForm, conclusionType"]
        CQS["Critical Questions:<br/>â€¢ cqKey, text<br/>â€¢ attackType, targetScope<br/>â€¢ burdenOfProof"]
        HIR["Hierarchy:<br/>â€¢ parentSchemeId<br/>â€¢ clusterTag<br/>â€¢ inheritCQs"]
    end
    
    subgraph HierarchyView["Hierarchy View"]
        SHV[SchemeHierarchyView.tsx]
        TN["TreeNode:<br/>â€¢ scheme, children<br/>â€¢ depth<br/>â€¢ ownCQCount<br/>â€¢ inheritedCQCount"]
    end
    
    subgraph API["API Endpoints"]
        SCHEMES["/api/schemes"]
        SCHEME_ID["/api/schemes/:id"]
    end
    
    ASP --> SL
    SL --> VM --> SHV
    SL --> SC
    SC --> BIF & TAX & CQS & HIR
    SL --> API
    SC --> API
</div></code></pre>
<h2 id="quick-reference-card">Quick Reference Card</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SCHEME ADMIN SYSTEM                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  PURPOSE: Manage argumentation scheme library                   â”‚
â”‚                                                                 â”‚
â”‚  ENTRY POINT: /admin/schemes                                    â”‚
â”‚                                                                 â”‚
â”‚  VIEW MODES:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“‹ LIST VIEW                                              â”‚ â”‚
â”‚  â”‚    â€¢ Filterable/searchable cards                          â”‚ â”‚
â”‚  â”‚    â€¢ Expandable details per scheme                        â”‚ â”‚
â”‚  â”‚    â€¢ Edit/Delete actions                                  â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ ğŸŒ³ HIERARCHY VIEW                                         â”‚ â”‚
â”‚  â”‚    â€¢ Tree visualization of parent/child schemes          â”‚ â”‚
â”‚  â”‚    â€¢ Cluster grouping by clusterTag                       â”‚ â”‚
â”‚  â”‚    â€¢ CQ inheritance visualization                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  SCHEME CREATOR SECTIONS:                                       â”‚
â”‚  1. Basic Information (key*, name*, summary*, description)     â”‚
â”‚  2. Macagno Taxonomy (purpose, source, materialRelation...)   â”‚
â”‚  3. Critical Questions (with attack types, burden of proof)   â”‚
â”‚  4. Hierarchy Settings (parent scheme, cluster tag)           â”‚
â”‚                                                                 â”‚
â”‚  AUTO-GENERATION:                                               â”‚
â”‚  â€¢ CQs can be auto-generated from taxonomy fields              â”‚
â”‚  â€¢ Uses generateCQsFromTaxonomy() function                     â”‚
â”‚                                                                 â”‚
â”‚  FILE LOCATIONS:                                                â”‚
â”‚  â€¢ app/admin/schemes/page.tsx (entry point)                    â”‚
â”‚  â€¢ components/admin/SchemeList.tsx (~529 lines)                â”‚
â”‚  â€¢ components/admin/SchemeCreator.tsx (~1239 lines)            â”‚
â”‚  â€¢ components/admin/SchemeHierarchyView.tsx (~425 lines)       â”‚
â”‚  â€¢ lib/argumentation/cqGeneration.ts                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="schemecreator-form-structure">SchemeCreator Form Structure</h2>
<pre class="hljs"><code><div><span class="hljs-comment">// Complete Scheme Form Data</span>
<span class="hljs-keyword">type</span> SchemeFormData = {
  <span class="hljs-comment">// BASIC INFO (Required)</span>
  key: <span class="hljs-built_in">string</span>;           <span class="hljs-comment">// e.g., "expert_opinion" (lowercase_with_underscores)</span>
  name: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// e.g., "Argument from Expert Opinion"</span>
  summary: <span class="hljs-built_in">string</span>;       <span class="hljs-comment">// One-line description</span>
  description?: <span class="hljs-built_in">string</span>;  <span class="hljs-comment">// Detailed explanation</span>
  
  <span class="hljs-comment">// MACAGNO TAXONOMY</span>
  purpose?: <span class="hljs-built_in">string</span>;      <span class="hljs-comment">// What the scheme aims to establish</span>
  source?: <span class="hljs-built_in">string</span>;       <span class="hljs-comment">// Original source (e.g., "Walton")</span>
  materialRelation?: <span class="hljs-built_in">string</span>;  <span class="hljs-comment">// cause, definition, analogy, authority, practical, correlation</span>
  reasoningType?: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// presumptive, deductive, inductive</span>
  ruleForm?: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// Logical structure</span>
  conclusionType?: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// Type of conclusion</span>
  epistemicMode?: <span class="hljs-built_in">string</span>;     <span class="hljs-comment">// FACTUAL, NORMATIVE, etc.</span>
  
  <span class="hljs-comment">// ENHANCED METADATA</span>
  tags?: <span class="hljs-built_in">string</span>[];            <span class="hljs-comment">// Categorization tags</span>
  examples?: <span class="hljs-built_in">string</span>[];        <span class="hljs-comment">// Usage examples</span>
  difficulty?: <span class="hljs-built_in">string</span>;        <span class="hljs-comment">// beginner, intermediate, advanced</span>
  identificationConditions?: <span class="hljs-built_in">string</span>[];  <span class="hljs-comment">// When to recognize this scheme</span>
  whenToUse?: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// Guidance text</span>
  
  <span class="hljs-comment">// PREMISES &amp; CONCLUSION</span>
  premises?: Premise[];       <span class="hljs-comment">// Array of {id, type, text, variables}</span>
  conclusion?: ConclusionTemplate;
  
  <span class="hljs-comment">// CRITICAL QUESTIONS</span>
  cqs: CriticalQuestion[];    <span class="hljs-comment">// Required: at least one</span>
  
  <span class="hljs-comment">// HIERARCHY (Phase 6D)</span>
  parentSchemeId?: <span class="hljs-built_in">string</span>;    <span class="hljs-comment">// Parent scheme for inheritance</span>
  clusterTag?: <span class="hljs-built_in">string</span>;        <span class="hljs-comment">// Grouping tag</span>
  inheritCQs?: <span class="hljs-built_in">boolean</span>;       <span class="hljs-comment">// Inherit parent's CQs</span>
};

<span class="hljs-comment">// Critical Question with Burden of Proof</span>
<span class="hljs-keyword">type</span> CriticalQuestion = {
  cqKey: <span class="hljs-built_in">string</span>;         <span class="hljs-comment">// e.g., "CQ1"</span>
  text: <span class="hljs-built_in">string</span>;          <span class="hljs-comment">// "Is E credible as an expert?"</span>
  attackType: <span class="hljs-string">"REBUTS"</span> | <span class="hljs-string">"UNDERCUTS"</span> | <span class="hljs-string">"UNDERMINES"</span>;
  targetScope: <span class="hljs-string">"conclusion"</span> | <span class="hljs-string">"inference"</span> | <span class="hljs-string">"premise"</span>;
  burdenOfProof?: <span class="hljs-string">"PROPONENT"</span> | <span class="hljs-string">"CHALLENGER"</span>;
  requiresEvidence?: <span class="hljs-built_in">boolean</span>;
  premiseType?: <span class="hljs-string">"ORDINARY"</span> | <span class="hljs-string">"ASSUMPTION"</span> | <span class="hljs-string">"EXCEPTION"</span> | <span class="hljs-literal">null</span>;
};
</div></code></pre>
<h2 id="scheme-admin-ui-layout">Scheme Admin UI Layout</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ARGUMENTATION SCHEMES                                          â”‚
â”‚  Manage and create custom argument schemes                      â”‚
â”‚                                                                 â”‚
â”‚  [ğŸ“‹ List] [ğŸŒ³ Hierarchy]              [â• Create Scheme]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [ğŸ” Search schemes...]        [Filter by relation: All â–¼]      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â–¶ Argument from Expert Opinion          expert_opinion   â”‚  â”‚
â”‚  â”‚   Appeals to expert knowledge to support a claim         â”‚  â”‚
â”‚  â”‚   [authority] [presumptive] [source: Walton]             â”‚  â”‚
â”‚  â”‚   6 critical questions                                    â”‚  â”‚
â”‚  â”‚                                          [âœï¸ Edit] [ğŸ—‘ï¸]  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â–¼ Argument from Analogy                 analogy          â”‚  â”‚
â”‚  â”‚   Compares two cases to transfer a property              â”‚  â”‚
â”‚  â”‚   [analogy] [presumptive] [source: Walton]               â”‚  â”‚
â”‚  â”‚   4 critical questions                                    â”‚  â”‚
â”‚  â”‚                                          [âœï¸ Edit] [ğŸ—‘ï¸]  â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚   EXPANDED DETAILS:                                      â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚   â”‚ Description: The argument from analogy...        â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                   â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ Taxonomy (Macagno &amp; Walton):                     â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ â€¢ Purpose: establish similarity                  â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ â€¢ Material Relation: analogy                     â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ â€¢ Reasoning Type: presumptive                    â”‚  â”‚  â”‚
â”‚  â”‚   â”‚                                                   â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ Critical Questions:                              â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ CQ1: Are the two cases truly analogous? [UNDERCUTS] â”‚
â”‚  â”‚   â”‚ CQ2: Are there relevant differences? [UNDERMINES]â”‚  â”‚  â”‚
â”‚  â”‚   â”‚ CQ3: Does the property actually transfer? [REBUTS]â”‚  â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h2 id="scheme-hierarchy-visualization">Scheme Hierarchy Visualization</h2>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HIERARCHY VIEW                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [ğŸ” Filter by cluster...]  [Expand All] [Collapse All] [ğŸ”„]    â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ Source-Based (clusterTag: authority)                        â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â–¶ ğŸ“„ Argument from Expert Opinion                           â”‚
â”‚  â”‚   â”‚  key: expert_opinion | CQs: 6 (own: 6, inherited: 0)    â”‚
â”‚  â”‚   â”‚                                                          â”‚
â”‚  â”‚   â”œâ”€â–¶ ğŸ“„ Argument from Expert Consensus                     â”‚
â”‚  â”‚   â”‚      key: expert_consensus | CQs: 2 (own: 2, inherited: 6)â”‚
â”‚  â”‚   â”‚      inheritCQs: true                                   â”‚
â”‚  â”‚   â”‚                                                          â”‚
â”‚  â”‚   â””â”€â–¶ ğŸ“„ Argument from Specialized Expert                   â”‚
â”‚  â”‚          key: specialized_expert | CQs: 3 (inherited: 6)    â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â–¶ ğŸ“„ Argument from Witness Testimony                        â”‚
â”‚  â”‚      key: witness_testimony | CQs: 5                         â”‚
â”‚  â”‚                                                              â”‚
â”‚  â””â”€â–¶ ğŸ“„ Argument from Authority                                â”‚
â”‚         key: authority | CQs: 4                                 â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ Causal (clusterTag: causal)                                 â”‚
â”‚  â”‚                                                              â”‚
â”‚  â”œâ”€â–¶ ğŸ“„ Argument from Cause to Effect                          â”‚
â”‚  â””â”€â–¶ ğŸ“„ Argument from Correlation to Cause                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h2 id="updated-file-location-quick-reference">Updated File Location Quick Reference</h2>
<pre class="hljs"><code><div>GLOSSARY / DICTIONARY:
â”œâ”€â”€ components/glossary/DefinitionSheet.tsx (main container)
â”œâ”€â”€ components/glossary/TermCard.tsx (term display)
â”œâ”€â”€ components/glossary/ProposeTermModal.tsx (create terms)
â”œâ”€â”€ components/glossary/ProposeAlternativeModal.tsx (add definitions)
â”œâ”€â”€ components/glossary/EndorseButton.tsx (voting)
â”œâ”€â”€ components/glossary/ViewHistoryModal.tsx (audit trail)
â”œâ”€â”€ components/glossary/ViewUsageModal.tsx (usage tracking)
â”œâ”€â”€ components/glossary/ExportGlossaryButton.tsx (export)
â”œâ”€â”€ components/glossary/GlossaryText.tsx (auto-linking)
â”œâ”€â”€ lib/glossary/parseGlossaryLinks.tsx (text parsing)
â””â”€â”€ app/api/deliberations/[id]/glossary/terms/route.ts

ISSUES SYSTEM:
â”œâ”€â”€ components/issues/IssuesList.tsx (list view)
â”œâ”€â”€ components/issues/IssueDetail.tsx (detail modal)
â”œâ”€â”€ components/issues/IssueComposer.tsx (create issues)
â”œâ”€â”€ components/issues/IssueComposerExtended.tsx (extended)
â”œâ”€â”€ components/issues/ClarificationRequestButton.tsx
â”œâ”€â”€ components/issues/NCMReviewCard.tsx (community defense)
â”œâ”€â”€ components/issues/MyIssuesDashboard.tsx (personal view)
â”œâ”€â”€ components/issues/IssueEntityPicker.tsx (link targets)
â”œâ”€â”€ components/issues/IssueBadge.tsx (status badge)
â””â”€â”€ app/api/deliberations/[id]/issues/route.ts

SCHEME ADMIN:
â”œâ”€â”€ app/admin/schemes/page.tsx (entry point)
â”œâ”€â”€ components/admin/SchemeList.tsx (~529 lines)
â”œâ”€â”€ components/admin/SchemeCreator.tsx (~1239 lines)
â”œâ”€â”€ components/admin/SchemeHierarchyView.tsx (~425 lines)
â”œâ”€â”€ lib/argumentation/cqGeneration.ts (auto-generation)
â””â”€â”€ app/api/schemes/route.ts
</div></code></pre>
<hr>
<p><em>Companion Document to AGORA_DELIBERATION_SYSTEM_ARCHITECTURE.md</em>
<em>Updated: December 12, 2025</em>
<em>Version: 1.1</em></p>

</body>
</html>
